#!/bin/sh
# Script to add wpa_supplicant networks through dmenu

wpa_cli scan && networks="$(wpa_cli scan_results | awk 'NR > 2 {print $5}')" || exit 23
sel="$(printf "$networks" | dmenu -c -l 12 -p "Select network: ")" || exit 3

pass="$(dmenu -P -c -l 1 -p "Password for \"$sel\":")" || exit 3

printf "network={\n\tssid=\"%s\"\n\tpsk=\"%s\"\n}" "$sel" "$pass" >> /etc/wpa_supplicant/wpa_supplicant.conf && dunstify " New network" "\"$sel\" was added to your networks" || dunstify "  Error" "Could not add \"$sel\" to your networks"
